> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/xQgYA8DopgZNCocvEhX6Ww)

![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXevMhFVfBXdX5Ptp0pmhsryAc6KuiafP2gl0AcTo4rGDia0Zibjh3z9TjyAzXnHKePic5awLErziciaCqgLg/640?wx_fmt=png)

**漏洞公告**

近日，安恒信息 CERT 监测到 Oracle 官方发布了安全公告，修复了 Weblogic 远程代码执行漏洞（CVE-2023-21839）。该漏洞允许未经身份验证的攻击者通过 T3、IIOP 协议进行网络访问并破坏易受攻击的 WebLogic Server，远程攻击者成功利用漏洞可在目标主机上执行代码。此漏洞已发现在野利用，建议受影响的用户尽快采取安全措施。

参考链接：

https://www.oracle.com/security-alerts/cpujan2023.html

漏洞风险矩阵参考（直接筛选 CVE 编号查询简约漏洞描述）：

https://www.oracle.com/security-alerts/cpujan2023verbose.html

Oracle 历史安全漏洞公告参考：

https://www.oracle.com/security-alerts/

一  

影响范围

受影响版本：

WebLogic Server 12.2.1.3.0

WebLogic Server 12.2.1.4.0

WebLogic Server 14.1.1.0.0

通过安恒 SUMAP 平台对全球部署的 Weblogic 进行统计，最新查询分布情况如下：

全球分布：

![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXeuicEjnoSzCCOXVbjjkxQzMHe7u0siaKZTJHPZ0e8V50dZWxga3iaJibjOgWB34D40skYWck1GrUVumow/640?wx_fmt=png)

国内分布：

![图片](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXeuicEjnoSzCCOXVbjjkxQzMHfzb2rBpFz9rwRm4WXwyXeI95gnXHpJea462XVc35yku1QIdoY2lOsA/640?wx_fmt=png)

二  

漏洞描述

Oracle WebLogic Server 是一个统一的可扩展平台, 专用于开发、部署和运行 Java 应用等适用于本地环境和云环境的企业应用。

Weblogic 远程代码执行漏洞（CVE-2023-21839）：该漏洞允许未经身份验证的攻击者通过 T3、IIOP 协议进行网络访问并破坏易受攻击的 WebLogic Server，远程攻击者成功利用漏洞可在目标主机上执行代码。

<table align="left"><tbody><tr><td width="140.66666666666666" valign="top" align="center"><strong>细节是否公开</strong></td><td width="122.66666666666667" valign="top" align="center"><strong>POC 状态</strong></td><td width="104.66666666666667" valign="top" align="center"><strong>EXP 状态</strong></td><td width="100.66666666666669" valign="top" align="center"><strong>在</strong><strong></strong><strong>野利用</strong></td></tr><tr><td width="142" valign="top" align="center">否</td><td width="122.66666666666667" valign="top" align="center">未公开</td><td width="104.66666666666667" valign="top" align="center">未公开</td><td width="100.66666666666669" valign="top" align="center">已发现</td></tr></tbody></table>

三  

漏洞检测

**本地检测：**

查看 Weblogic 版本和补丁安装的情况。

![图片](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXetCwPakpuNKCuEG86xRocLZpUnE9gG7UtuI4A3gUQCOTQouRFAVwT0YTfTt4sDZicpe7C22sjgOolg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

上图目标中，如果 Weblogic 版本在漏洞影响范围内且未对系统安装相应补丁，则说明存在风险。

  

**T3 协议探测：**

Nmap 工具提供了 Weblogic T3 协议的扫描脚本，名称为 weblogic-t3-info.nse。使用方式如下图所示：

![图片](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXetCwPakpuNKCuEG86xRocLZZNroCGc0uyNtLRe4usAyVwEWuhlONNFVDRcEsFDcPXhvMHVMoOibJVw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

上图目标中开启了 T3 协议，Weblogic 版本在漏洞影响范围内且未对系统安装相应补丁，则说明存在风险。

四  

缓解措施

**高危：**目前已检测到在野利用，漏洞细节和测试代码虽暂未公开，但恶意攻击者可以通过对比分析出漏洞触发点，建议受影响用户及时升级至安全版本。 

**官方建议：**

1、目前官方已发布安全补丁，建议受影响的用户及时应用补丁。

参考链接：

https://www.oracle.com/security-alerts/cpujan2023.html

**临时缓解措施：**

1、针对 T3 协议的临时缓解加固措施  

使用连接筛选器临时阻止外部访问 7001 端口的 T3/T3s 协议：

连接筛选器：weblogic.security.net.ConnectionFilterImpl

![图片](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXevbMADYYGx7aicvyXoNkyibyoLnQxmwc6rc2EeX8gatrGu7twtPZPnb1Qpa2dHoCgyEeXAXGYwVLEzw/640?wx_fmt=png)

规则示例：

0.0.0.0/0 * 7001 deny t3 t3s   # 拒绝所有访问

允许和拒绝指定 IP 规则示例：

192.168.1.0/24 * 7001 allow t3 t3s  #允许指定 IP 段访问

192.168.2.0/24 * 7001 deny t3 t3s  #拒绝指定 IP 段访问

连接筛选器说明参考（英文）：

https://docs.oracle.com/cd/E24329_01/web.1211/e24485/con_filtr.htm#SCPRG377

2、禁用 IIOP 协议

在 Weblogic 控制台中，选择 “base_domain”->“监视” 进入 “AdminServer”-> “协议”->“IIOP” 中，取消 “启用 IIOP” 的勾选。并重启 Weblogic 项目，使配置生效。

![图片](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXevbMADYYGx7aicvyXoNkyibyofas1SJuJVrKknV1YnC73Bu3aiaUpwS1SnIRicl9Gu8oBRibt4SF3xTyRg/640?wx_fmt=png)

安恒信息 CERT

2023 年 1 月